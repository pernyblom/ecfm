train:
  batch_size: 16
  num_steps: 1
  lr: 0.0002
  device: cuda
  seed: 0
  recon_every: 0
  recon_num_patches: 0
  recon_out_dir: outputs/recon
  recon_upscale: 8
  probe_every: 0
  probe_subset_size: 16
  probe_subset_seed: 0
  probe_region_seed: 0
  probe_regions_per_sample: 16
  probe_epochs: 10
  probe_batch_size: 16
  probe_lr: 0.001
  probe_cache_dir: outputs/linear_probe_cache
  patch_loss_blur_radius: 1
  count_loss_weight: 0.0
  checkpoint_dir: outputs/checkpoints
  checkpoint_every: 0
  resume_path: ""
  load_model_only: false

model:
  patch_size: 32
  embed_dim: 384
  num_heads: 6
  num_layers: 12
  decoder_embed_dim: 96
  decoder_num_heads: 6
  decoder_num_layers: 4
  mlp_ratio: 4.0
  plane_embed_dim: 64
  metadata_dim: 9
  mask_ratio: 0.4
  use_pos_embedding: false
  use_relative_bias: true
  rel_bias_hidden_dim: 64

data:
  dataset_name: "thu-eact"
  dataset_path: "datasets/THU-EACT-50-CHL"
  split: "train"
  num_samples: 0
  max_samples: 32
  max_events: 0
  image_width: 346
  image_height: 260
  time_unit: 0.000001
  time_bins: 64
  region_scales: [64, 128, 192]
  region_scales_x: [64, 128, 192]
  region_scales_y: [64, 128, 192]
  region_time_scales: [0.25, 0.5, 0.75]
  region_sampling: grid
  grid_x: 1
  grid_y: 1
  grid_t: 1
  grid_plane_mode: all
  fixed_region_sizes: false
  plane_types: ["xy_m45", "xy_p45", "yt"]
  plane_types_active: ["yt", "xy_p45", "xy_m45"]
  num_regions: 0
  num_regions_choices: []
  subset_seed: 0
  fixed_region_seed: 0
  fixed_region_positions_global: false
  fixed_single_region: false
  patch_divider: 0
  patch_norm: region_max
  patch_norm_eps: 1e-6
  augmentations: ["rotate"]
  rotation_max_deg: 15.0
  augmentation_invalidate_prob: 0.05
  cache_max_samples: 0
  cache_token_max_samples: 0
  cache_token_dir: outputs/token_cache2
  cache_token_variant_mode: random
  cache_token_clear_on_start: true
  cache_token_variants_per_sample: 1
  cache_token_drop_prob: 0.0
