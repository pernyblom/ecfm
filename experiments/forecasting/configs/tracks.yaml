data:
  images_root: outputs/fred_reps
  labels_root: datasets/FRED
  labels_subdir: Event_YOLO
  supervision: tracks
  tracks_file: cleaned_tracks.txt
  label_time_unit: 1.0e-6
  track_time_unit: 1.0
  time_align: start
  frame_size: [1280, 720]
  max_samples_train: 3680
  max_samples_val: 940
  representations: ["xt", "yt", "cstr3"]
  past_steps: 12
  future_steps: 24
  stride: 1
  split_files:
    train: datasets/FRED/dataset_splits/canonical/train_split.txt
    val: datasets/FRED/dataset_splits/canonical/test_split.txt
  image_size: [224, 224]
  seed: 123456
  cache_dir: outputs/track_cache

model:
  # type: transformer
  type: gru
  cnn_channels: [16, 32, 64]
  feature_dim: 128
  use_past_boxes: true
  rnn_hidden: 256
  rnn_layers: 2
  # predict_past: true
  predict_past: false
  # pos_encoding: learned
  pos_encoding: sinusoidal
  d_model: 256
  nhead: 4
  num_encoder_layers: 4
  num_decoder_layers: 4
  dim_feedforward: 512
  dropout: 0.1

train:
  batch_size: 32
  epochs: 200
  lr: 2.0e-4
  weight_decay: 0.0
  device: cuda
  log_every: 20
  past_loss_weight: 0.5
  future_loss_weight: 1.0
  visualize: true
  vis_samples: 16
  vis_output_dir: outputs/forecast_vis_tracks_gru
  vis_backdrop_rep: null
  vis_backdrop_index: null
  checkpoint_dir: outputs/forecast_ckpt_tracks_gru
  checkpoint_every: 1
  resume_from: null

eval:
  batch_size: 32
  device: cuda
